sg_owin <- as(sg_sp, "owin")
summary(sg_owin)
clinicsSG_ppp = clinics_ppp[sg_owin]
plot(clinicsSG_ppp)
summary(clinicsSG_ppp)
qt <- quadrat.test(clinicsSG_ppp, nx = 20, ny = 15)
qt
plot(clinicsSG_ppp)
plot(qt, add = TRUE, cex =.1)
kde_clinicsSG_bw <- density(clinicsSG_ppp, sigma=bw.diggle,
edge=TRUE, kernel="gaussian")
plot(kde_clinicsSG_bw)
clnicsSG_ppp.km <- rescale(clinicsSG_ppp, 1000, "km")
kde_clinicsSG_bw_rescaled <- density(clnicsSG_ppp.km, sigma=bw.diggle, edge=TRUE, kernel="gaussian")
plot(kde_clinicsSG_bw_rescaled)
kde_clinicsSG_600 <- density(clnicsSG_ppp.km, sigma=0.6, edge=TRUE, kernel="gaussian")
plot(kde_clinicsSG_600)
gridded_kde_clinicsSG_bw_rescaled <- as.SpatialGridDataFrame.im(kde_clinicsSG_bw_rescaled)
spplot(gridded_kde_clinicsSG_bw_rescaled)
gridded_kde_clinicsSG_bw<- as.SpatialGridDataFrame.im(kde_clinicsSG_bw)
kde_clinicsSG_bw_raster <- raster(gridded_kde_clinicsSG_bw)
projection(kde_clinicsSG_bw_raster) <- CRS("+init=EPSG:3414")
tmap_mode("view")
tm_shape(kde_clinicsSG_bw_raster, bbox = sg) +
tm_raster("v") +
tm_layout(basemaps = c("OpenStreetMap"))
pg = mpsz[mpsz@data$PLN_AREA_N == "PUNGGOL",]
tm = mpsz[mpsz@data$PLN_AREA_N == "TAMPINES",]
ck = mpsz[mpsz@data$PLN_AREA_N == "CHOA CHU KANG",]
jw = mpsz[mpsz@data$PLN_AREA_N == "JURONG WEST",]
clinics_sp = as(clinics, "SpatialPoints")
pg_sp = as(pg, "SpatialPolygons")
tm_sp = as(tm, "SpatialPolygons")
ck_sp = as(ck, "SpatialPolygons")
jw_sp = as(jw, "SpatialPolygons")
pg_owin = as(pg_sp, "owin")
tm_owin = as(tm_sp, "owin")
ck_owin = as(ck_sp, "owin")
jw_owin = as(jw_sp, "owin")
clinics_ppp <- unique(clinics_ppp)
clinics_pg_ppp = clinics_ppp[pg_owin]
clinics_tm_ppp = clinics_ppp[tm_owin]
clinics_ck_ppp = clinics_ppp[ck_owin]
clinics_jw_ppp = clinics_ppp[jw_owin]
clinics_pg_ppp.km = rescale(clinics_pg_ppp, 1000, "km")
clinics_tm_ppp.km = rescale(clinics_tm_ppp, 1000, "km")
clinics_ck_ppp.km = rescale(clinics_ck_ppp, 1000, "km")
clinics_jw_ppp.km = rescale(clinics_jw_ppp, 1000, "km")
plot(clinics_pg_ppp)
plot(clinics_tm_ppp)
plot(clinics_ck_ppp)
plot(clinics_jw_ppp)
kde_clinics_pg_bw <- density(clinics_pg_ppp.km, sigma=0.25, edge=TRUE, kernel="gaussian")
gridded_kde_clinics_pg_bw<- as.SpatialGridDataFrame.im(kde_clinics_pg_bw)
spplot(gridded_kde_clinics_pg_bw)
kde_clinics_tm_bw <- density(clinics_tm_ppp.km, sigma=0.25, edge=TRUE, kernel="gaussian")
gridded_kde_clinics_tm_bw<- as.SpatialGridDataFrame.im(kde_clinics_tm_bw)
spplot(gridded_kde_clinics_tm_bw)
kde_clinics_ck_bw <- density(clinics_ck_ppp.km, sigma=0.25, edge=TRUE, kernel="gaussian")
gridded_kde_clinics_ck_bw<- as.SpatialGridDataFrame.im(kde_clinics_ck_bw)
spplot(gridded_kde_clinics_ck_bw)
kde_clinics_jw_bw <- density(clinics_jw_ppp.km, sigma=0.25, edge=TRUE, kernel="gaussian")
gridded_kde_clinics_jw_bw<- as.SpatialGridDataFrame.im(kde_clinics_jw_bw)
spplot(gridded_kde_clinics_jw_bw)
L_ck = Lest(clinics_ck_ppp, correction = "Ripley")
plot(L_ck, . -r ~ r, ylab= "L(d)-r", xlab = "d(m)")
L_ck.csr <- envelope(clinics_ck_ppp, Lest, nsim = 99, rank = 1, glocal=TRUE)
plot(L_ck.csr, . - r ~ r, xlab="d", ylab="L(d)-r")
L_pg = Lest(clinics_pg_ppp, correction = "Ripley")
plot(L_pg, . -r ~ r, ylab= "L(d)-r", xlab = "d(m)")
L_pg.csr <- envelope(clinics_pg_ppp, Lest, nsim = 99, rank = 1, glocal=TRUE)
plot(L_pg.csr, . - r ~ r, xlab="d", ylab="L(d)-r")
L_tm = Lest(clinics_tm_ppp, correction = "Ripley")
plot(L_tm, . -r ~ r, ylab= "L(d)-r", xlab = "d(m)")
L_tm.csr <- envelope(clinics_tm_ppp, Lest, nsim = 99, rank = 1, glocal=TRUE)
plot(L_tm.csr, . - r ~ r, xlab="d", ylab="L(d)-r")
L_jw = Lest(clinics_jw_ppp, correction = "Ripley")
plot(L_jw, . -r ~ r, ylab= "L(d)-r", xlab = "d(m)")
L_jw.csr <- envelope(clinics_jw_ppp, Lest, nsim = 99, rank = 1, glocal=TRUE)
plot(L_jw.csr, . - r ~ r, xlab="d", ylab="L(d)-r")
packages = c('rgdal', 'maptools', 'raster','spatstat', 'tmap', 'sf', 'tidyverse')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p) }
library(p,character.only = T) }
mpsz = st_read(dsn = "data", layer = "MP14_SUBZONE_WEB_PL")
population = read_csv("data/respopagsex2000to2017.csv")
popage2017pre <- population %>%
filter(Time == 2017) %>%
filter(AG == "65_to_69" | AG == "70_to_74" | AG == "75_to_79" | AG == "80_to_84" | AG == "85_and_over") %>%
group_by(SZ)
popage2017pre_added <- aggregate(Pop ~ SZ, popage2017pre, sum)
clinics = read_csv("data/clinics_hcidirectory.csv")
tcm = read_csv("data/tcm_tcmboard.csv")
HDB = read_csv("data/hdb_property_information.csv")
HDB_sf <- st_as_sf(HDB, coords = c("X", "Y"), crs = st_crs(mpsz))
popByDwelling = read_csv("data/residents-by-age-group-and-type-of-dwelling-detailed-categories-annual.csv")
popByDwelling2017 <- popByDwelling %>%
filter(year == 2017) %>%
filter(level_1 == "65-69 Years"
| level_1 == "85 Years & Over"
| level_1 == "70-74 Years"
| level_1 == "75-79 Years"
| level_1 == "80-84 Years") %>%
group_by(level_3)
popByDwelling2017
popByDwelling2017_added <- aggregate(value ~ level_3, popByDwelling2017, sum)
mpsz_HDB <- st_join(HDB_sf,mpsz)
mpsz_HDB$`1_2room_sold` <- mpsz_HDB$`1room_sold` + mpsz_HDB$`2room_sold`
mpsz_HDB_1_2_room = aggregate(mpsz_HDB$`1_2room_sold`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_1_2_room' = 'x')
mpsz_HDB_3_room_added = aggregate(mpsz_HDB$`3room_sold`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_3_room' = 'x')
mpsz_HDB_4_room_added = aggregate(mpsz_HDB$`4room_sold`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_4_room' = 'x')
mpsz_HDB_5_room_added = aggregate(mpsz_HDB$`5room_sold`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_5_room' = 'x')
mpsz_HDB_added <- left_join(mpsz_HDB_1_2_room, mpsz_HDB_3_room_added, by ='SUBZONE') %>%
left_join(., mpsz_HDB_4_room_added, by = 'SUBZONE') %>%
left_join(., mpsz_HDB_5_room_added, by = 'SUBZONE')
mpsz_HDB_added$`total_units` <- mpsz_HDB_added$`No_of_1_2_room` + mpsz_HDB_added$`No_of_3_room` + mpsz_HDB_added$`No_of_4_room` + mpsz_HDB_added$`No_of_5_room`
View(mpsz_HDB)
mpsz_HDB <- st_join(HDB_sf,mpsz)
mpsz_HDB$`1_2room_total` <- mpsz_HDB$`1room_sold` + mpsz_HDB$`2room_sold` + mpsz_HDB$`1room_rental` + mpsz_HDB$`2room_rental`
mpsz_HDB_1_2_room = aggregate(mpsz_HDB$`1_2room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_1_2_room' = 'x')
mpsz_HDB$`3room_total` <- mpsz_HDB$`3room_sold` + mpsz_HDB$`3room_rental` + mpsz_HDB$`other_room_rental`
mpsz_HDB_3_room_added = aggregate(mpsz_HDB$`3room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_3_room' = 'x')
mpsz_HDB_4_room_added = aggregate(mpsz_HDB$`4room_sold`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_4_room' = 'x')
mpsz_HDB$`5_room_exec` <- mpsz_HDB$`5room_sold` + mpsz_HDB$`exec_sold`
mpsz_HDB_5_room_exec_added = aggregate(mpsz_HDB$`5_room_exec`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_5_room' = 'x')
mpsz_HDB_added <- left_join(mpsz_HDB_1_2_room, mpsz_HDB_3_room_added, by ='SUBZONE') %>%
left_join(., mpsz_HDB_4_room_added, by = 'SUBZONE') %>%
left_join(., mpsz_HDB_5_room_exec_added, by = 'SUBZONE')
mpsz_HDB_added$`total_units` <- mpsz_HDB_added$`No_of_1_2_room` + mpsz_HDB_added$`No_of_3_room` + mpsz_HDB_added$`No_of_4_room` + mpsz_HDB_added$`No_of_5_room`
View(mpsz_HDB_added)
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_units <- sum(mpsz_HDB_added$No_of_5_room)
View(mpsz_HDB)
mpsz_HDB <- st_join(HDB_sf,mpsz)
mpsz_HDB$`1_2room_total` <- mpsz_HDB$`1room_sold` + mpsz_HDB$`2room_sold` + mpsz_HDB$`1room_rental` + mpsz_HDB$`2room_rental`
mpsz_HDB_1_2_room = aggregate(mpsz_HDB$`1_2room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_1_2_room' = 'x')
mpsz_HDB$`3room_total` <- mpsz_HDB$`3room_sold` + mpsz_HDB$`3room_rental` + mpsz_HDB$`other_room_rental`
mpsz_HDB_3_room_added = aggregate(mpsz_HDB$`3room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_3_room' = 'x')
mpsz_HDB$`4_room_total` <- mpsz_HDB$`4room_sold`
mpsz_HDB_4_room_added = aggregate(mpsz_HDB$`4_room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_4_room' = 'x')
mpsz_HDB$`5_room_exec_total` <- mpsz_HDB$`5room_sold` + mpsz_HDB$`exec_sold`
mpsz_HDB_5_room_exec_added = aggregate(mpsz_HDB$`5_room_exec_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_5_room' = 'x')
mpsz_HDB_added <- left_join(mpsz_HDB_1_2_room, mpsz_HDB_3_room_added, by ='SUBZONE') %>%
left_join(., mpsz_HDB_4_room_added, by = 'SUBZONE') %>%
left_join(., mpsz_HDB_5_room_exec_added, by = 'SUBZONE')
mpsz_HDB_added$`total_units` <- mpsz_HDB_added$`No_of_1_2_room` + mpsz_HDB_added$`No_of_3_room` + mpsz_HDB_added$`No_of_4_room` + mpsz_HDB_added$`No_of_5_room`
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_units <- sum(mpsz_HDB_added$No_of_5_room)
popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 1- And 2-Room Flats"]
ifelse(mpsz_HDB$`5room_sold` == 0, 0, mpsz_HDB$`5room_sold`/total_5_room_units) *
popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 5-Room Flats"]
View(popByDwelling2017_added)
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_units <- sum(mpsz_HDB_added$No_of_5_room)
mpsz_HDB$No_of_Elderly_in_block_1_2 <- ifelse(mpsz_HDB$`1_2room_sold` == 0, 0, mpsz_HDB$`1_2room_sold`/total_1_2_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 1- And 2-Room Flats"]
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_units <- sum(mpsz_HDB_added$No_of_5_room)
mpsz_HDB$No_of_Elderly_in_block_1_2 <- ifelse(mpsz_HDB$`1_2room_total` == 0, 0, mpsz_HDB$`1_2room_total`/total_1_2_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 1- And 2-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_3 <- ifelse(mpsz_HDB$`3room_total` == 0, 0, mpsz_HDB$`3room_total`/total_3_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 3-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_4 <- ifelse(mpsz_HDB$`4room_total` == 0, 0, mpsz_HDB$`4room_total`/total_4_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 4-Room Flats"]
mpsz_HDB <- st_join(HDB_sf,mpsz)
mpsz_HDB$`1_2room_total` <- mpsz_HDB$`1room_sold` + mpsz_HDB$`2room_sold` + mpsz_HDB$`1room_rental` + mpsz_HDB$`2room_rental`
mpsz_HDB_1_2_room = aggregate(mpsz_HDB$`1_2room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_1_2_room' = 'x')
mpsz_HDB$`3room_total` <- mpsz_HDB$`3room_sold` + mpsz_HDB$`3room_rental` + mpsz_HDB$`other_room_rental`
mpsz_HDB_3_room_added = aggregate(mpsz_HDB$`3room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_3_room' = 'x')
mpsz_HDB$`4_room_total` <- mpsz_HDB$`4room_sold`
mpsz_HDB_4_room_added = aggregate(mpsz_HDB$`4_room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_4_room' = 'x')
mpsz_HDB$`5_room_exec_total` <- mpsz_HDB$`5room_sold` + mpsz_HDB$`exec_sold`
mpsz_HDB_5_room_exec_added = aggregate(mpsz_HDB$`5_room_exec_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_5_room_exec' = 'x')
mpsz_HDB_added <- left_join(mpsz_HDB_1_2_room, mpsz_HDB_3_room_added, by ='SUBZONE') %>%
left_join(., mpsz_HDB_4_room_added, by = 'SUBZONE') %>%
left_join(., mpsz_HDB_5_room_exec_added, by = 'SUBZONE')
mpsz_HDB_added$`total_units` <- mpsz_HDB_added$`No_of_1_2_room` + mpsz_HDB_added$`No_of_3_room` + mpsz_HDB_added$`No_of_4_room` + mpsz_HDB_added$`No_of_5_room`
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_exec_units <- sum(mpsz_HDB_added$No_of_5_room_exec)
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_exec_units <- sum(mpsz_HDB_added$No_of_5_room_exec)
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_units <- sum(mpsz_HDB_added$No_of_5_room)
mpsz_HDB$No_of_Elderly_in_block_1_2 <- ifelse(mpsz_HDB$`1_2room_total` == 0, 0, mpsz_HDB$`1_2room_total`/total_1_2_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 1- And 2-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_3 <- ifelse(mpsz_HDB$`3room_total` == 0, 0, mpsz_HDB$`3room_total`/total_3_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 3-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_4 <- ifelse(mpsz_HDB$`4room_total` == 0, 0, mpsz_HDB$`4room_total`/total_4_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 4-Room Flats"]
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_units <- sum(mpsz_HDB_added$No_of_5_room)
mpsz_HDB$No_of_Elderly_in_block_1_2 <- ifelse(mpsz_HDB$`1_2room_total` == 0, 0, mpsz_HDB$`1_2room_total`/total_1_2_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 1- And 2-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_3 <- ifelse(mpsz_HDB$`3room_total` == 0, 0, mpsz_HDB$`3room_total`/total_3_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 3-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_4 <- ifelse(mpsz_HDB$`4room_total` == 0, 0, mpsz_HDB$`4room_total`/total_4_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 4-Room Flats"]
mpsz_HDB <- st_join(HDB_sf,mpsz)
mpsz_HDB$`1_2room_total` <- mpsz_HDB$`1room_sold` + mpsz_HDB$`2room_sold` + mpsz_HDB$`1room_rental` + mpsz_HDB$`2room_rental`
mpsz_HDB_1_2_room = aggregate(mpsz_HDB$`1_2room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_1_2_room' = 'x')
mpsz_HDB$`3room_total` <- mpsz_HDB$`3room_sold` + mpsz_HDB$`3room_rental` + mpsz_HDB$`other_room_rental`
mpsz_HDB_3_room_added = aggregate(mpsz_HDB$`3room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_3_room' = 'x')
mpsz_HDB$`4room_total` <- mpsz_HDB$`4room_sold`
mpsz_HDB_4_room_added = aggregate(mpsz_HDB$`4_room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_4_room' = 'x')
mpsz_HDB <- st_join(HDB_sf,mpsz)
mpsz_HDB$`1_2room_total` <- mpsz_HDB$`1room_sold` + mpsz_HDB$`2room_sold` + mpsz_HDB$`1room_rental` + mpsz_HDB$`2room_rental`
mpsz_HDB_1_2_room = aggregate(mpsz_HDB$`1_2room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_1_2_room' = 'x')
mpsz_HDB$`3room_total` <- mpsz_HDB$`3room_sold` + mpsz_HDB$`3room_rental` + mpsz_HDB$`other_room_rental`
mpsz_HDB_3_room_added = aggregate(mpsz_HDB$`3room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_3_room' = 'x')
mpsz_HDB$`4room_total` <- mpsz_HDB$`4room_sold`
mpsz_HDB_4_room_added = aggregate(mpsz_HDB$`4room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_4_room' = 'x')
mpsz_HDB$`5_room_exec_total` <- mpsz_HDB$`5room_sold` + mpsz_HDB$`exec_sold`
mpsz_HDB_5_room_exec_added = aggregate(mpsz_HDB$`5_room_exec_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_5_room_exec' = 'x')
mpsz_HDB_added <- left_join(mpsz_HDB_1_2_room, mpsz_HDB_3_room_added, by ='SUBZONE') %>%
left_join(., mpsz_HDB_4_room_added, by = 'SUBZONE') %>%
left_join(., mpsz_HDB_5_room_exec_added, by = 'SUBZONE')
mpsz_HDB_added$`total_units` <- mpsz_HDB_added$`No_of_1_2_room` + mpsz_HDB_added$`No_of_3_room` + mpsz_HDB_added$`No_of_4_room` + mpsz_HDB_added$`No_of_5_room`
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_exec_units <- sum(mpsz_HDB_added$No_of_5_room_exec)
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_units <- sum(mpsz_HDB_added$No_of_5_room)
mpsz_HDB$No_of_Elderly_in_block_1_2 <- ifelse(mpsz_HDB$`1_2room_total` == 0, 0, mpsz_HDB$`1_2room_total`/total_1_2_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 1- And 2-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_3 <- ifelse(mpsz_HDB$`3room_total` == 0, 0, mpsz_HDB$`3room_total`/total_3_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 3-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_4 <- ifelse(mpsz_HDB$`4room_total` == 0, 0, mpsz_HDB$`4room_total`/total_4_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 4-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_5 <- ifelse(mpsz_HDB$`5room_exec_total` == 0, 0, mpsz_HDB$`5room_exec_total`/total_5_room_exec_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 5-Room And Executive Flats"]
mpsz_HDB <- st_join(HDB_sf,mpsz)
mpsz_HDB$`1_2room_total` <- mpsz_HDB$`1room_sold` + mpsz_HDB$`2room_sold` + mpsz_HDB$`1room_rental` + mpsz_HDB$`2room_rental`
mpsz_HDB_1_2_room = aggregate(mpsz_HDB$`1_2room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_1_2_room' = 'x')
mpsz_HDB$`3room_total` <- mpsz_HDB$`3room_sold` + mpsz_HDB$`3room_rental` + mpsz_HDB$`other_room_rental`
mpsz_HDB_3_room_added = aggregate(mpsz_HDB$`3room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_3_room' = 'x')
mpsz_HDB$`4room_total` <- mpsz_HDB$`4room_sold`
mpsz_HDB_4_room_added = aggregate(mpsz_HDB$`4room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_4_room' = 'x')
mpsz_HDB$`5room_exec_total` <- mpsz_HDB$`5room_sold` + mpsz_HDB$`exec_sold`
mpsz_HDB_5_room_exec_added = aggregate(mpsz_HDB$`5room_exec_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_5_room_exec' = 'x')
mpsz_HDB_added <- left_join(mpsz_HDB_1_2_room, mpsz_HDB_3_room_added, by ='SUBZONE') %>%
left_join(., mpsz_HDB_4_room_added, by = 'SUBZONE') %>%
left_join(., mpsz_HDB_5_room_exec_added, by = 'SUBZONE')
mpsz_HDB_added$`total_units` <- mpsz_HDB_added$`No_of_1_2_room` + mpsz_HDB_added$`No_of_3_room` + mpsz_HDB_added$`No_of_4_room` + mpsz_HDB_added$`No_of_5_room`
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_exec_units <- sum(mpsz_HDB_added$No_of_5_room_exec)
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_units <- sum(mpsz_HDB_added$No_of_5_room)
mpsz_HDB$No_of_Elderly_in_block_1_2 <- ifelse(mpsz_HDB$`1_2room_total` == 0, 0, mpsz_HDB$`1_2room_total`/total_1_2_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 1- And 2-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_3 <- ifelse(mpsz_HDB$`3room_total` == 0, 0, mpsz_HDB$`3room_total`/total_3_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 3-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_4 <- ifelse(mpsz_HDB$`4room_total` == 0, 0, mpsz_HDB$`4room_total`/total_4_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 4-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_5 <- ifelse(mpsz_HDB$`5room_exec_total` == 0, 0, mpsz_HDB$`5room_exec_total`/total_5_room_exec_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 5-Room And Executive Flats"]
mpsz_HDB$No_of_Elderly_in_block <- mpsz_HDB$No_of_Elderly_in_block_1_2 + mpsz_HDB$No_of_Elderly_in_block_3 + mpsz_HDB$No_of_Elderly_in_block_4 + mpsz_HDB$No_of_Elderly_in_block_5
mpsz_HDB$No_of_Elderly_in_block <- round(mpsz_HDB$No_of_Elderly_in_block)
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_units <- sum(mpsz_HDB_added$No_of_5_room)
mpsz_HDB$No_of_Elderly_in_block_1_2 <- ifelse(mpsz_HDB$`1_2room_total` == 0, 0, mpsz_HDB$`1_2room_total`/total_1_2_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 1- And 2-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_3 <- ifelse(mpsz_HDB$`3room_total` == 0, 0, mpsz_HDB$`3room_total`/total_3_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 3-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_4 <- ifelse(mpsz_HDB$`4room_total` == 0, 0, mpsz_HDB$`4room_total`/total_4_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 4-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_5 <- ifelse(mpsz_HDB$`5room_exec_total` == 0, 0, mpsz_HDB$`5room_exec_total`/total_5_room_exec_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 5-Room And Executive Flats"]
mpsz_HDB$No_of_Elderly_in_block <- mpsz_HDB$No_of_Elderly_in_block_1_2 + mpsz_HDB$No_of_Elderly_in_block_3 + mpsz_HDB$No_of_Elderly_in_block_4 + mpsz_HDB$No_of_Elderly_in_block_5
mpsz_HDB$No_of_Elderly_in_block <- round(mpsz_HDB$No_of_Elderly_in_block)
packages = c('rgdal', 'maptools', 'raster','spatstat', 'tmap', 'sf', 'tidyverse')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p) }
library(p,character.only = T) }
mpsz = st_read(dsn = "data", layer = "MP14_SUBZONE_WEB_PL")
population = read_csv("data/respopagsex2000to2017.csv")
popage2017pre <- population %>%
filter(Time == 2017) %>%
filter(AG == "65_to_69" | AG == "70_to_74" | AG == "75_to_79" | AG == "80_to_84" | AG == "85_and_over") %>%
group_by(SZ)
popage2017pre_added <- aggregate(Pop ~ SZ, popage2017pre, sum)
clinics = read_csv("data/clinics_hcidirectory.csv")
tcm = read_csv("data/tcm_tcmboard.csv")
HDB = read_csv("data/hdb_property_information.csv")
HDB_sf <- st_as_sf(HDB, coords = c("X", "Y"), crs = st_crs(mpsz))
popByDwelling = read_csv("data/residents-by-age-group-and-type-of-dwelling-detailed-categories-annual.csv")
popByDwelling2017 <- popByDwelling %>%
filter(year == 2017) %>%
filter(level_1 == "65-69 Years"
| level_1 == "85 Years & Over"
| level_1 == "70-74 Years"
| level_1 == "75-79 Years"
| level_1 == "80-84 Years") %>%
group_by(level_3)
popByDwelling2017
popByDwelling2017_added <- aggregate(value ~ level_3, popByDwelling2017, sum)
mpsz_HDB <- st_join(HDB_sf,mpsz)
mpsz_HDB$`1_2room_total` <- mpsz_HDB$`1room_sold` + mpsz_HDB$`2room_sold` + mpsz_HDB$`1room_rental` + mpsz_HDB$`2room_rental`
mpsz_HDB_1_2_room = aggregate(mpsz_HDB$`1_2room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_1_2_room' = 'x')
mpsz_HDB$`3room_total` <- mpsz_HDB$`3room_sold` + mpsz_HDB$`3room_rental` + mpsz_HDB$`other_room_rental`
mpsz_HDB_3_room_added = aggregate(mpsz_HDB$`3room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_3_room' = 'x')
mpsz_HDB$`4room_total` <- mpsz_HDB$`4room_sold`
mpsz_HDB_4_room_added = aggregate(mpsz_HDB$`4room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_4_room' = 'x')
mpsz_HDB$`5room_exec_total` <- mpsz_HDB$`5room_sold` + mpsz_HDB$`exec_sold`
mpsz_HDB_5_room_exec_added = aggregate(mpsz_HDB$`5room_exec_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_5_room_exec' = 'x')
mpsz_HDB_added <- left_join(mpsz_HDB_1_2_room, mpsz_HDB_3_room_added, by ='SUBZONE') %>%
left_join(., mpsz_HDB_4_room_added, by = 'SUBZONE') %>%
left_join(., mpsz_HDB_5_room_exec_added, by = 'SUBZONE')
mpsz_HDB_added$`total_units` <- mpsz_HDB_added$`No_of_1_2_room` + mpsz_HDB_added$`No_of_3_room` + mpsz_HDB_added$`No_of_4_room` + mpsz_HDB_added$`No_of_5_room`
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_exec_units <- sum(mpsz_HDB_added$No_of_5_room_exec)
mpsz_HDB$No_of_Elderly_in_block <- round(mpsz_HDB$No_of_Elderly_in_block)
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_units <- sum(mpsz_HDB_added$No_of_5_room)
mpsz_HDB$No_of_Elderly_in_block_1_2 <- ifelse(mpsz_HDB$`1_2room_total` == 0, 0, mpsz_HDB$`1_2room_total`/total_1_2_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 1- And 2-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_3 <- ifelse(mpsz_HDB$`3room_total` == 0, 0, mpsz_HDB$`3room_total`/total_3_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 3-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_4 <- ifelse(mpsz_HDB$`4room_total` == 0, 0, mpsz_HDB$`4room_total`/total_4_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 4-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_5 <- ifelse(mpsz_HDB$`5room_exec_total` == 0, 0, mpsz_HDB$`5room_exec_total`/total_5_room_exec_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 5-Room And Executive Flats"]
mpsz_HDB$No_of_Elderly_in_block <- mpsz_HDB$No_of_Elderly_in_block_1_2 + mpsz_HDB$No_of_Elderly_in_block_3 + mpsz_HDB$No_of_Elderly_in_block_4 + mpsz_HDB$No_of_Elderly_in_block_5
mpsz_HDB$No_of_Elderly_in_block <- round(mpsz_HDB$No_of_Elderly_in_block)
shiny::runApp('C:/IS415/NeighbourhoodWatchDocs')
View(tcm)
tcm = read_csv("data/tcm_tcmboard.csv")
tcm <- unique(tcm$tcm_place_name)
tcm = read_csv("data/tcm_tcmboard.csv")
#tcm[!duplicated(tcm$tc), ]
tcm = read_csv("data/tcm_tcmboard.csv")
tcm[!duplicated(tcm$tcm_place_name), ]
tcm = read_csv("data/tcm_tcmboard.csv")[!duplicated(tcm$tcm_place_name), ]
#tcm <- tcm[!duplicated(tcm$tcm_place_name), ]
View(clinics)
clinics = read_csv("data/clinics_hcidirectory.csv") %>%
c("clinic_name", "address", "LAT", "LONG")
clinics = read_csv("data/clinics_hcidirectory.csv")
keeps <-  c("clinic_name", "address", "LAT", "LONG")
clinics[keeps]
clinics = read_csv("data/clinics_hcidirectory.csv")
keeps <-  c("clinic_name", "address", "LAT", "LONG")
clinics <- clinics[keeps]
clinics = read_csv("data/clinics_hcidirectory.csv")
keeps <-  c("clinic_name", "address", "LAT", "LONG", "X" , "Y")
clinics <- clinics[keeps]
packages <- c('rgdal', 'maptools', 'raster','spatstat', 'tmap', 'sf', 'tidyverse')
for (p in packages){
if(!require(p, character.only <- T)){
install.packages(p) }
library(p,character.only <- T) }
install.packages(p)
packages <- c('rgdal', 'maptools', 'raster','spatstat', 'tmap', 'sf', 'tidyverse')
for (p in packages){
if(!require(p, character.only <- T)){
install.packages(p) }
library(p,character.only <- T) }
packages <- c('rgdal', 'maptools', 'raster','spatstat', 'tmap', 'sf', 'tidyverse')
for (p in packages){
if(!require(p, character.only <- T)){
install.packages(p) }
library(p,character.only <- T) }
packages <- c('rgdal', 'maptools', 'raster','spatstat', 'tmap', 'sf', 'tidyverse')
for (p in packages){
if(!require(p, character.only <- T)){
install.packages(p) }
library(p,character.only <- T) }
packages <- c('rgdal', 'maptools', 'raster','spatstat', 'tmap', 'sf', 'tidyverse')
for (p in packages){
if(!require(p, character.only <- T)){
install.packages(p) }
library(p,character.only <- T) }
packages = c('rgdal', 'maptools', 'raster','spatstat', 'tmap', 'sf', 'tidyverse')
for (p in packages){
if(!require(p, character.only <- T)){
install.packages(p) }
library(p,character.only <- T) }
shiny::runApp('C:/IS415/IS415-Neighbourhood-WatchDocs')
shiny::runApp('C:/IS415/IS415-Neighbourhood-WatchDocs')
runApp('C:/IS415/IS415-Neighbourhood-WatchDocs')
model1 <- allocations(mpsz_HDB_filtered_sp, clinics_combined_filtered_sp, p=4)
packages = c('rgdal', 'maptools', 'raster','spatstat', 'tmap', 'sf', 'tidyverse', 'SpatialAcc', 'tbart', 'cclust')
for (p in packages){
if(!require(p, character.only = T)){
install.packages(p) }
library(p,character.only = T) }
mpsz = st_read(dsn = "data", layer = "MP14_SUBZONE_WEB_PL")
mpsz <- mpsz[order(mpsz$SUBZONE_N),]
population = read_csv("data/respopagsex2000to2017.csv")
popage2017pre <- population %>%
filter(Time == 2017) %>%
filter(AG == "65_to_69" | AG == "70_to_74" | AG == "75_to_79" | AG == "80_to_84" | AG == "85_and_over") %>%
group_by(SZ)
popage2017pre_added <- aggregate(Pop ~ SZ, popage2017pre, sum)
clinics = read_csv("data/clinics_hcidirectory.csv")
clinics_essentials <- c("clinic_name", "address", "LAT", "LONG", "X", "Y") # remove postal code
clinics <- clinics[clinics_essentials]
tcm = read_csv("data/tcm_tcmboard.csv")
tcm <- tcm[!duplicated(tcm$tcm_place_name), ]
tcm_essentials <- c("tcm_place_name", "tcm_address", "LAT", "LONG", "X", "Y")
tcm <- tcm[tcm_essentials]
names(tcm)[names(tcm) == "tcm_place_name"] <- "clinic_name"
names(tcm)[names(tcm) == "tcm_address"] <- "address"
clinics_combined <- rbind(clinics, tcm)
clinics_combined <- st_join(st_as_sf(clinics_combined,
coords = c("X", "Y"), crs = st_crs(mpsz)), mpsz)
HDB = read_csv("data/hdb_property_information.csv")
HDB_sf <- st_as_sf(HDB, coords = c("X", "Y"), crs = st_crs(mpsz))
popByDwelling = read_csv("data/residents-by-age-group-and-type-of-dwelling-detailed-categories-annual.csv")
popByDwelling2017 <- popByDwelling %>%
filter(year == 2017) %>%
filter(level_1 == "65-69 Years"
| level_1 == "85 Years & Over"
| level_1 == "70-74 Years"
| level_1 == "75-79 Years"
| level_1 == "80-84 Years") %>%
group_by(level_3)
popByDwelling2017
popByDwelling2017_added <- aggregate(value ~ level_3, popByDwelling2017, sum)
mpsz_HDB <- st_join(HDB_sf,mpsz)
mpsz_HDB$`1_2room_total` <- mpsz_HDB$`1room_sold` + mpsz_HDB$`2room_sold` + mpsz_HDB$`1room_rental` + mpsz_HDB$`2room_rental`
mpsz_HDB_1_2_room = aggregate(mpsz_HDB$`1_2room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_1_2_room' = 'x')
mpsz_HDB$`3room_total` <- mpsz_HDB$`3room_sold` + mpsz_HDB$`3room_rental` + mpsz_HDB$`other_room_rental`
mpsz_HDB_3_room_added = aggregate(mpsz_HDB$`3room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_3_room' = 'x')
mpsz_HDB$`4room_total` <- mpsz_HDB$`4room_sold`
mpsz_HDB_4_room_added = aggregate(mpsz_HDB$`4room_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_4_room' = 'x')
mpsz_HDB$`5room_exec_total` <- mpsz_HDB$`5room_sold` + mpsz_HDB$`exec_sold`
mpsz_HDB_5_room_exec_added = aggregate(mpsz_HDB$`5room_exec_total`, by=list(SUBZONE=mpsz_HDB$SUBZONE_N), FUN=sum) %>%
rename('No_of_5_room_exec' = 'x')
mpsz_HDB_added <- left_join(mpsz_HDB_1_2_room, mpsz_HDB_3_room_added, by ='SUBZONE') %>%
left_join(., mpsz_HDB_4_room_added, by = 'SUBZONE') %>%
left_join(., mpsz_HDB_5_room_exec_added, by = 'SUBZONE')
mpsz_HDB_added$`total_units` <- mpsz_HDB_added$`No_of_1_2_room` + mpsz_HDB_added$`No_of_3_room` + mpsz_HDB_added$`No_of_4_room` + mpsz_HDB_added$`No_of_5_room`
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_exec_units <- sum(mpsz_HDB_added$No_of_5_room_exec)
total_1_2_room_units <- sum(mpsz_HDB_added$No_of_1_2_room)
total_3_room_units <- sum(mpsz_HDB_added$No_of_3_room)
total_4_room_units <- sum(mpsz_HDB_added$No_of_4_room)
total_5_room_units <- sum(mpsz_HDB_added$No_of_5_room)
mpsz_HDB$No_of_Elderly_in_block_1_2 <- ifelse(mpsz_HDB$`1_2room_total` == 0, 0, mpsz_HDB$`1_2room_total`/total_1_2_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 1- And 2-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_3 <- ifelse(mpsz_HDB$`3room_total` == 0, 0, mpsz_HDB$`3room_total`/total_3_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 3-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_4 <- ifelse(mpsz_HDB$`4room_total` == 0, 0, mpsz_HDB$`4room_total`/total_4_room_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 4-Room Flats"]
mpsz_HDB$No_of_Elderly_in_block_5 <- ifelse(mpsz_HDB$`5room_exec_total` == 0, 0, mpsz_HDB$`5room_exec_total`/total_5_room_exec_units) * popByDwelling2017_added$value[popByDwelling2017_added$level_3=="HDB 5-Room And Executive Flats"]
mpsz_HDB$No_of_Elderly_in_block <- mpsz_HDB$No_of_Elderly_in_block_1_2 + mpsz_HDB$No_of_Elderly_in_block_3 + mpsz_HDB$No_of_Elderly_in_block_4 + mpsz_HDB$No_of_Elderly_in_block_5
mpsz_HDB$No_of_Elderly_in_block <- round(mpsz_HDB$No_of_Elderly_in_block)
#assign capacity of 2 per clinic
clinics_combined['capacity'] <- 2
mpsz_HDB_coords <- mpsz_HDB %>% st_coordinates()
clinics_combined_coords <- clinics_combined %>% st_coordinates()
dm <- distance(mpsz_HDB_coords, clinics_combined_coords)
acc_hansen <- data.frame(ac(mpsz_HDB$No_of_Elderly_in_block, clinics_combined$capacity, dm, power=0.01, family="Hansen"))
colnames(acc_hansen) <- "accHansen"
acc_hansen <- tbl_df(acc_hansen)
HDB_acc <- bind_cols(mpsz_HDB, acc_hansen)
tmap_mode("view")
tm_shape(mpsz_HDB)+
tm_symbols(size = 0.1)+
tm_shape(HDB_acc)+
tm_bubbles(col = "accHansen",
n=5,
style = "quantile",
size = 0.1,
border.col = "black",
border.lwd = 1)
mpsz_HDB_filtered <- mpsz_HDB[mpsz_HDB$SUBZONE_N=="ADMIRALTY", ]
clinics_combined_filtered <- clinics_combined[clinics_combined$SUBZONE_N=="ADMIRALTY", ]
clinics_combined_filtered <- na.omit(clinics_combined_filtered)
mpsz_HDB_filtered_sp <- as_Spatial(mpsz_HDB_filtered)
clinics_combined_filtered_sp <- as_Spatial(clinics_combined_filtered)
model1 <- allocations(mpsz_HDB_filtered_sp, clinics_combined_filtered_sp, p=4)
head(model1)
runApp('C:/IS415/IS415-Neighbourhood-WatchDocs')
